# https://stackoverflow.com/questions/25107806/estimate-formants-using-lpc-in-python# https://www.quora.com/How-do-I-create-a-real-time-plot-with-matplotlib-and-Tkinterimport tkinter as tkfrom random import randintimport numpy as np# these two imports are importantfrom matplotlib.backends.backend_tkagg import FigureCanvasTkAggfrom matplotlib.figure import Figureimport threadingfrom voystick import recording as rcfrom voystick import formant_predict as fpcontinuePlotting = False# CHUNK = 2**10# RATE = 44100## p = pyaudio.PyAudio()# stream = p.open(format=pyaudio.paInt16, channels=1, rate=RATE, input=True,#                 frames_per_buffer=CHUNK)ear = rc.SWHear()def change_state():    global continuePlotting    if continuePlotting == True:        continuePlotting = False    else:        continuePlotting = Truedef data_initialize():    f = open("data.txt","w")    for i in range(10):        f.write(str(randint(0,10))+'\n')    f.close()def data_points():    f = open("data.txt", "a")    # for i in range(10):    data = np.fromstring(stream.read(CHUNK,exception_on_overflow = False), dtype=np.int16)    peak = np.average(np.abs(data)) * 2    # f.write(str(randint(0, 10)) + '\n')    f.write(str(peak) + '\n')    f.close()    f = open("data.txt", "r")    data = f.readlines()    f.close()    l = []    tail = len(data)    for i in range(tail-10,tail):        l.append(float(data[i].rstrip("\n")))    return ldef app():    # initialise a window.    root = tk.Tk()    root.config(background='white')    root.geometry("1000x1000")    lab = tk.Label(root, text="Live Plotting", bg='white').pack()    fig = Figure(figsize=(5, 4))    ax = fig.add_subplot(121)    ax.set_xlabel("F1")    ax.set_ylabel("F2")    ax.grid()    ax2 = fig.add_subplot(122)    ax2.set_xlabel("F1")    ax2.set_ylabel("F2")    ax2.grid()    graph = FigureCanvasTkAgg(fig, master=root)    graph.get_tk_widget().pack(side="top", fill='both', expand=True)    ear.stream_start()    def plotter():        # data_initialize()        while continuePlotting:            ear.tape_add()            ax.cla()            # ax.grid()            # dpts = np.fromstring(stream.read(CHUNK, exception_on_overflow=False), dtype=np.int16)            # ax.set_xlim(0,11)            dpts = ear.tape            # dpts = np.fft.fft(snl)            if np.linalg.norm(dpts) > 10000:                formants = fp.get_formants(dpts)                f1 = formants[1]                f2 = formants[2]            else:                f1 = 0                f2 = 0            # ax.set_ylim(-2**15,2**15)            ax.set_ylim(-100,10000)            ax.set_xlim(-100,10000)            # dpts = data_points()            # ax.plot(range(len(dpts)), dpts,c=range(len(dpts)),cmap='Blues',linewidth=2)            # ax.semilogx(np.arange(0,44100),dpts[44100:],linewidth=2, markersize=12)            # ax.plot(range(len(dpts)), dpts, linewidth=2, markersize=12)            ax.scatter(f1,f2)            graph.draw()            # time.sleep(.100)    def gui_handler():        change_state()        threading.Thread(target=plotter).start()    b = tk.Button(root, text="Start/Stop", command=gui_handler, bg="red", fg="white")    b.pack(side="bottom")    root.mainloop()app()ear.close()